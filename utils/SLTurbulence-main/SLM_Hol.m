function hologram = SLM_Hol(mode, H, V, X, Y, Gx, Gy)
            
    fx = [0	0.00200000000000000	0.00400000000000000	0.00600000000000000	0.0100000000000000	0.0120000000000000	0.0140000000000000	0.0160000000000000	0.0180000000000000	0.0200000000000000	0.0240000000000000	0.0260000000000000	0.0280000000000000	0.0300000000000000	0.0320000000000000	0.0340000000000000	0.0380000000000000	0.0400000000000000	0.0420000000000000	0.0440000000000000	0.0460000000000000	0.0480000000000000	0.0520000000000000	0.0540000000000000	0.0560000000000000	0.0580000000000000	0.0600000000000000	0.0620000000000000	0.0660000000000000	0.0680000000000000	0.0700000000000000	0.0720000000000000	0.0740000000000000	0.0760000000000000	0.0800000000000000	0.0820000000000000	0.0840000000000000	0.0860000000000000	0.0880000000000000	0.0900000000000000	0.0940000000000000	0.0960000000000000	0.0980000000000000	0.100000000000000	0.102000000000000	0.104000000000000	0.108000000000000	0.110000000000000	0.112000000000000	0.114000000000000	0.116000000000000	0.118000000000000	0.122000000000000	0.124000000000000	0.126000000000000	0.128000000000000	0.130000000000000	0.132000000000000	0.136000000000000	0.138000000000000	0.140000000000000	0.142000000000000	0.144000000000000	0.148000000000000	0.150000000000000	0.152000000000000	0.154000000000000	0.156000000000000	0.158000000000000	0.162000000000000	0.164000000000000	0.166000000000000	0.168000000000000	0.170000000000000	0.172000000000000	0.176000000000000	0.178000000000000	0.180000000000000	0.182000000000000	0.184000000000000	0.188000000000000	0.190000000000000	0.192000000000000	0.194000000000000	0.196000000000000	0.198000000000000	0.202000000000000	0.204000000000000	0.206000000000000	0.208000000000000	0.210000000000000	0.214000000000000	0.216000000000000	0.218000000000000	0.220000000000000	0.222000000000000	0.224000000000000	0.228000000000000	0.230000000000000	0.232000000000000	0.234000000000000	0.236000000000000	0.240000000000000	0.242000000000000	0.244000000000000	0.246000000000000	0.248000000000000	0.252000000000000	0.254000000000000	0.256000000000000	0.258000000000000	0.260000000000000	0.262000000000000	0.266000000000000	0.268000000000000	0.270000000000000	0.272000000000000	0.274000000000000	0.278000000000000	0.280000000000000	0.282000000000000	0.284000000000000	0.286000000000000	0.290000000000000	0.292000000000000	0.294000000000000	0.296000000000000	0.298000000000000	0.302000000000000	0.304000000000000	0.306000000000000	0.308000000000000	0.310000000000000	0.314000000000000	0.316000000000000	0.318000000000000	0.320000000000000	0.324000000000000	0.326000000000000	0.328000000000000	0.330000000000000	0.332000000000000	0.336000000000000	0.338000000000000	0.340000000000000	0.342000000000000	0.344000000000000	0.348000000000000	0.350000000000000	0.352000000000000	0.354000000000000	0.358000000000000	0.360000000000000	0.362000000000000	0.364000000000000	0.366000000000000	0.370000000000000	0.372000000000000	0.374000000000000	0.376000000000000	0.380000000000000	0.382000000000000	0.384000000000000	0.386000000000000	0.390000000000000	0.392000000000000	0.394000000000000	0.396000000000000	0.398000000000000	0.402000000000000	0.404000000000000	0.406000000000000	0.408000000000000	0.412000000000000	0.414000000000000	0.416000000000000	0.418000000000000	0.422000000000000	0.424000000000000	0.426000000000000	0.428000000000000	0.432000000000000	0.434000000000000	0.436000000000000	0.438000000000000	0.442000000000000	0.444000000000000	0.446000000000000	0.448000000000000	0.452000000000000	0.454000000000000	0.456000000000000	0.458000000000000	0.462000000000000	0.464000000000000	0.466000000000000	0.468000000000000	0.472000000000000	0.474000000000000	0.476000000000000	0.480000000000000	0.482000000000000	0.484000000000000	0.486000000000000	0.490000000000000	0.492000000000000	0.494000000000000	0.498000000000000	0.500000000000000	0.502000000000000	0.504000000000000	0.508000000000000	0.510000000000000	0.512000000000000	0.514000000000000	0.518000000000000	0.520000000000000	0.522000000000000	0.526000000000000	0.528000000000000	0.530000000000000	0.534000000000000	0.536000000000000	0.538000000000000	0.540000000000000	0.544000000000000	0.546000000000000	0.548000000000000	0.552000000000000	0.554000000000000	0.556000000000000	0.560000000000000	0.562000000000000	0.564000000000000	0.568000000000000	0.570000000000000	0.572000000000000	0.576000000000000	0.578000000000000	0.580000000000000	0.584000000000000	0.586000000000000	0.588000000000000	0.592000000000000	0.594000000000000	0.596000000000000	0.600000000000000	0.602000000000000	0.604000000000000	0.608000000000000	0.610000000000000	0.612000000000000	0.616000000000000	0.618000000000000	0.620000000000000	0.624000000000000	0.626000000000000	0.628000000000000	0.632000000000000	0.634000000000000	0.636000000000000	0.640000000000000	0.642000000000000	0.646000000000000	0.648000000000000	0.650000000000000	0.654000000000000	0.656000000000000	0.658000000000000	0.662000000000000	0.664000000000000	0.668000000000000	0.670000000000000	0.672000000000000	0.676000000000000	0.678000000000000	0.682000000000000	0.684000000000000	0.686000000000000	0.690000000000000	0.692000000000000	0.696000000000000	0.698000000000000	0.700000000000000	0.704000000000000	0.706000000000000	0.710000000000000	0.712000000000000	0.716000000000000	0.718000000000000	0.720000000000000	0.724000000000000	0.726000000000000	0.730000000000000	0.732000000000000	0.736000000000000	0.738000000000000	0.742000000000000	0.744000000000000	0.746000000000000	0.750000000000000	0.752000000000000	0.756000000000000	0.758000000000000	0.762000000000000	0.764000000000000	0.768000000000000	0.770000000000000	0.774000000000000	0.776000000000000	0.780000000000000	0.782000000000000	0.786000000000000	0.788000000000000	0.792000000000000	0.794000000000000	0.798000000000000	0.800000000000000	0.804000000000000	0.806000000000000	0.810000000000000	0.812000000000000	0.816000000000000	0.818000000000000	0.822000000000000	0.824000000000000	0.828000000000000	0.830000000000000	0.834000000000000	0.836000000000000	0.840000000000000	0.844000000000000	0.846000000000000	0.850000000000000	0.852000000000000	0.856000000000000	0.858000000000000	0.862000000000000	0.866000000000000	0.868000000000000	0.872000000000000	0.874000000000000	0.878000000000000	0.882000000000000	0.884000000000000	0.888000000000000	0.890000000000000	0.894000000000000	0.898000000000000	0.900000000000000	0.904000000000000	0.908000000000000	0.910000000000000	0.914000000000000	0.918000000000000	0.920000000000000	0.924000000000000	0.928000000000000	0.930000000000000	0.934000000000000	0.938000000000000	0.940000000000000	0.944000000000000	0.948000000000000	0.950000000000000	0.954000000000000	0.958000000000000	0.960000000000000	0.964000000000000	0.968000000000000	0.972000000000000	0.974000000000000	0.978000000000000	0.982000000000000	0.986000000000000	0.988000000000000	0.992000000000000	0.996000000000000	1	1.00400000000000	1.00600000000000	1.01000000000000	1.01400000000000	1.01800000000000	1.02200000000000	1.02400000000000	1.02800000000000	1.03200000000000	1.03600000000000	1.04000000000000	1.04400000000000	1.04800000000000	1.05200000000000	1.05400000000000	1.05800000000000	1.06200000000000	1.06600000000000	1.07000000000000	1.07400000000000	1.07800000000000	1.08200000000000	1.08600000000000	1.09000000000000	1.09400000000000	1.09800000000000	1.10200000000000	1.10600000000000	1.11000000000000	1.11400000000000	1.11800000000000	1.12200000000000	1.12600000000000	1.13000000000000	1.13400000000000	1.13800000000000	1.14200000000000	1.14600000000000	1.15000000000000	1.15600000000000	1.16000000000000	1.16400000000000	1.16800000000000	1.17200000000000	1.17600000000000	1.18200000000000	1.18600000000000	1.19000000000000	1.19400000000000	1.20000000000000	1.20400000000000	1.20800000000000	1.21400000000000	1.21800000000000	1.22200000000000	1.22800000000000	1.23200000000000	1.23600000000000	1.24200000000000	1.24600000000000	1.25200000000000	1.25600000000000	1.26200000000000	1.26600000000000	1.27200000000000	1.27600000000000	1.28200000000000	1.28600000000000	1.29200000000000	1.29800000000000	1.30200000000000	1.30800000000000	1.31400000000000	1.31800000000000	1.32400000000000	1.33000000000000	1.33600000000000	1.34200000000000	1.34600000000000	1.35200000000000	1.35800000000000	1.36400000000000	1.37000000000000	1.37600000000000	1.38400000000000	1.39000000000000	1.39600000000000	1.40200000000000	1.40800000000000	1.41600000000000	1.42200000000000	1.42800000000000	1.43600000000000	1.44400000000000	1.45000000000000	1.45800000000000	1.46600000000000	1.47200000000000	1.48000000000000	1.48800000000000	1.49600000000000	1.50400000000000	1.51400000000000	1.52200000000000	1.53200000000000	1.54000000000000	1.55000000000000	1.56000000000000	1.57000000000000	1.58000000000000	1.59200000000000	1.60400000000000	1.61600000000000	1.62800000000000	1.64200000000000	1.65800000000000	1.67400000000000	1.69200000000000	1.71200000000000	1.73600000000000	1.76800000000000	1.84200000000000];

    if max(max(mode)) == 0
        hologram = zeros(size(mode));
    else
        U = mode./max(abs(mode(:))); % normalize the mode to be between 0 and 1
        A = abs(U); % get amplitude of the mode
        A = round(A*500)/500; % get to range of 500 for fx.mat code
        Theta = angle(mode); % get phase of desired mode
        f = zeros(V,H);
        if (nargin == 6)
            hologram = mod(Theta+2*pi*(Gx.*X+Gy.*Y),2*pi);
        else
            for m = 1:V
                for n = 1:H
                    temp = A(m,n); % get amplitude value at that point
                    f(m,n) = fx(round(500*temp)+1); % invert the Bessel function numerically and set that to hologram
                end
            end
            hologram = f.*sin(Theta+2*pi*(Gx.*X+Gy.*Y));
        end
        hologram = hologram - min(hologram(:));
        hologram = hologram./max(hologram(:));
    end
end